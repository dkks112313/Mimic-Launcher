<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <title>Mimic Launcher</title>
    <link href="style.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">

    <script>
        function updateConfigField(field, value) {
            const updatedConfig = {
                [field]: value
            };
            window.electronAPI.sendSaveConfig(updatedConfig);
        }

        window.electronAPI.onDefaultPath((event, data) => {
            updateConfigField('path', data.path);
        })

        window.electronAPI.onDefaultJava((event, data) => {
            updateConfigField('java', data.path);
        })

        window.electronAPI.onData((event, data) => {
            console.log('–î–∞–Ω–Ω—ã–µ –∏–∑ Node:', data.message)
        })

        window.electronAPI.onPathDirectory((event, data) => {
            if(data.path !== undefined) {
                document.getElementById('game-directory').value = data.path
                updateConfigField('path', data.path);
            }
        })

        window.electronAPI.onPathJava((event, data) => {
            if(data.path !== undefined) {
                document.getElementById('java-path').value = data.path
                updateConfigField('java', data.path);
            }
        })

        window.electronAPI.onConfigLoad((config) => {
            document.getElementById("username").value = config.core.name;
            document.getElementById("modloader").value = config.core.mode;

            document.getElementById("version").value = config.core.version;
            changeFunction();

            document.getElementById("memory-input").value = config.core.ram;
            document.getElementById("memory").value = config.core.ram;
            document.getElementById("memory-value").textContent = config.core.ram + ' GB';

            document.getElementById("game-directory").value = config.core.path;
            document.getElementById("java-path").value = config.core.java;
            document.getElementById("jvm-arguments").value = config.core.jvm;

            document.getElementById("language-select").value = config.core.language;
            updateLanguage(config.core.language);

            document.getElementById("auto-updates").checked = config.core.update;
            document.getElementById("alpha-versions").checked = config.core.alpha;
        });
    </script>
</head>
<body>
<div class="app-container">
    <nav class="sidebar">
        <ul>
            <li><a class="active" data-page="home" href="#" title="Home">üè†</a></li>
            <li><a data-page="settings" href="#" title="Settings">‚öôÔ∏è</a></li>
            <li><a data-page="mods" href="#" title="Mods">üß©</a></li>
        </ul>
    </nav>
    <main class="content">
        <div class="page active" id="home">
            <div class="page-content-main">
                <h1 class="pixel-title" data-translate="welcomeTitle">Welcome to Mimic Launcher</h1>
                <div class="launcher-options">
                    <div class="option-group">
                        <label data-translate="username" for="username">Username:</label>
                        <input data-translate-placeholder="usernamePlaceholder" id="username"
                               placeholder="Enter your Minecraft username" type="text">
                    </div>
                    <div class="option-group">
                        <label data-translate="gameVersion" for="version">Game Version:</label>
                        <select id="version"></select>
                    </div>
                    <div class="option-group">
                        <label data-translate="modLoader" for="modloader">Mod Loader:</label>
                        <select id="modloader" onchange="changeFunction()">
                            <option value="vanilla">Vanilla</option>
                            <option value="forge">Forge</option>
                            <option value="fabric">Fabric</option>
                            <option value="quilt">Quilt</option>
                            <option value="neoforge">NeoForge</option>
                        </select>
                    </div>
                    <button data-translate="launchGame" id="launch-btn">Launch Game</button>
                </div>
                <div id="status-message"></div>
            </div>
        </div>
        <div class="page" id="settings">
            <div class="page-content-settings">
                <h1 class="pixel-title" data-translate="settings">Settings</h1>
                <div class="launcher-options">
                    <div class="option-group full-width">
                        <label data-translate="gameDirectory" for="game-directory">Game Directory:</label>
                        <div class="input-with-buttons">
                            <input data-translate-placeholder="gameDirectoryPlaceholder" id="game-directory"
                                   placeholder="Enter game directory" type="text">
                            <button data-translate="selectPathButton" id="game-directory-select">Select Path</button>
                            <button data-translate="defaultButton" id="game-directory-default">Default</button>
                            <button data-translate="openButton" id="game-directory-open">Open</button>
                        </div>
                    </div>
                    <div class="option-group full-width">
                        <label data-translate="javaPath" for="java-path">Java Path:</label>
                        <div class="input-with-buttons">
                            <input data-translate-placeholder="javaPathPlaceholder" id="java-path"
                                   placeholder="Enter Java path" type="text">
                            <button data-translate="selectPathButton" id="java-path-select">Select Path</button>
                            <button data-translate="defaultButton" id="java-path-default">Default</button>
                        </div>
                    </div>
                    <div class="option-row">
                        <div class="option-group">
                            <label data-translate="memoryAllocation" for="memory-input">Memory Allocation (GB):</label>
                            <input id="memory-input" max="16" min="1" type="number" value="4">
                            <input id="memory" max="16" min="1" type="range" value="4">
                            <span id="memory-value">4 GB</span>
                        </div>
                        <div class="option-group">
                            <label data-translate="jvmArguments" for="jvm-arguments">JVM Arguments:</label>
                            <input data-translate-placeholder="jvmArgumentsPlaceholder" id="jvm-arguments"
                                   placeholder="Enter JVM arguments" type="text">
                        </div>
                    </div>
                    <div class="option-row">
                        <div class="option-group">
                            <label data-translate="language" for="language-select">Language:</label>
                            <select id="language-select">
                                <option value="en">English</option>
                                <option value="ru">–†—É—Å—Å–∫–∏–π</option>
                                <option value="de">Deutsch</option>
                                <option value="fr">Fran√ßais</option>
                            </select>
                        </div>
                        <div class="option-group">
                            <label><input id="auto-updates" type="checkbox"> <span data-translate="enableAutoUpdates">Enable Auto Updates</span></label>
                            <label><input id="alpha-versions" type="checkbox"> <span data-translate="showAlphaVersions">Show Alpha Versions</span></label>
                        </div>
                    </div>
                    <!--<button data-translate="saveSettings" id="save-settings">Save Settings</button>-->
                </div>
            </div>
        </div>
        <div class="page" id="mods">
            <div class="page-content-mods">
                <h1 class="pixel-title" data-translate="mods">Mods</h1>
                <div class="launcher-options">
                    <div class="option-group">
                        <label data-translate="searchMods" for="mod-search">Search Mods:</label>
                        <input data-translate-placeholder="searchModsPlaceholder" id="mod-search"
                               placeholder="Search for mods" type="text">
                    </div>
                    <div id="mod-list">
                        <!-- Mod list will be populated dynamically -->
                    </div>
                    <button data-translate="installMods" id="install-mods">Install Selected Mods</button>
                </div>
            </div>
        </div>
    </main>
</div>
<script src="render.js"></script>
<script src="version.js"></script>
<script src="navigation.js"></script>
<script src="language.js"></script>
<script src="memory.js"></script>
<script>
    function updateConfigField(field, value) {
        const updatedConfig = {
            [field]: value
        };
        window.electronAPI.sendSaveConfig(updatedConfig);
    }

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Ñ–æ—Ä–º—ã
    document.getElementById('username').addEventListener('input', (event) => {
        updateConfigField('name', event.target.value);
    });

    document.getElementById('version').addEventListener('change', (event) => {
        updateConfigField('version', event.target.value);
    });

    document.getElementById('modloader').addEventListener('change', (event) => {
        updateConfigField('mode', event.target.value);
    });

    document.getElementById('memory-input').addEventListener('input', (event) => {
        updateConfigField('ram', event.target.value);
    });

    document.getElementById('memory').addEventListener('input', (event) => {
        updateConfigField('ram', event.target.value);
    });

    document.getElementById('game-directory').addEventListener('input', (event) => {
        updateConfigField('path', event.target.value);
    });

    document.getElementById('java-path').addEventListener('input', (event) => {
        updateConfigField('java', event.target.value);
    });

    document.getElementById('jvm-arguments').addEventListener('input', (event) => {
        updateConfigField('jvm', event.target.value);
    });

    document.getElementById('language-select').addEventListener('change', (event) => {
        updateConfigField('language', event.target.value);
    });

    document.getElementById('auto-updates').addEventListener('change', (event) => {
        updateConfigField('update', event.target.checked);
    });

    document.getElementById('alpha-versions').addEventListener('change', (event) => {
        updateConfigField('alpha', event.target.checked);
    });
</script>
</body>
</html>
